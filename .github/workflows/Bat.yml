name: Run install.bat on Windows

on:
  workflow_dispatch:

jobs:
  run_install:
    runs-on: windows-2022
    timeout-minutes: 30

    steps:
      # 1️⃣ Получаем код репозитория Sandbox.run-server
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          repository: your-username/Sandbox.run-server
          ref: main

      # 2️⃣ Создаём папку для логов
      - name: Prepare logs folder
        shell: powershell
        run: |
          if (-not (Test-Path logs)) { New-Item -ItemType Directory -Path logs }

      # 3️⃣ Запускаем install.bat и сохраняем лог
      - name: Run install.bat
        shell: cmd
        run: |
          install.bat > logs/install.log 2>&1

      # 4️⃣ Загружаем лог как артефакт
      - name: Upload log
        uses: actions/upload-artifact@v3
        with:
          name: install-bat-log
          path: logs/install.log
